#!/usr/bin/env bpftrace

BEGIN
{
    printf("Starting bpftrace script...\n");
}

// Trace the execution of the 'execve' system call
tracepoint:syscalls:sys_enter_execve
{
    // Extract the command name from the full path
    $cmd = str(args->filename);

    if ($cmd == "/usr/bin/cat" || $cmd == "/bin/cat")
    {
        printf("cat executed: %s\n", $cmd);
    }
}

END
{
    printf("Ending bpftrace script...\n");
}

